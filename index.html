<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows 11 Recovery Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #323130;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: #0078d4;
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        h1, h2, h3, h4 {
            margin-bottom: 20px;
        }
        
        .main-content {
            display: flex;
            margin: 30px 0;
            flex-direction: row;
        }
        
        .sidebar {
            width: 30%;
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-right: 20px;
        }
        
        .content-area {
            width: 70%;
            background: white;
            padding: 30px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .scenario-btn {
            display: block;
            width: 100%;
            padding: 15px;
            margin-bottom: 10px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: left;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .scenario-btn:hover {
            background-color: #f0f0f0;
            border-color: #0078d4;
        }
        
        .scenario-btn.active {
            background-color: #0078d4;
            color: white;
            border-color: #0078d4;
        }
        
        .recovery-option {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
        }
        
        .priority-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }
        
        .priority-1 {
            background-color: #107c10;
            color: white;
        }
        
        .priority-2 {
            background-color: #ffb900;
            color: #323130;
        }
        
        .priority-3 {
            background-color: #d13438;
            color: white;
        }
        
        .steps-list {
            list-style-type: none;
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .steps-list li {
            position: relative;
            padding-left: 30px;
            margin-bottom: 10px;
        }
        
        .steps-list li:before {
            content: "•";
            position: absolute;
            left: 10px;
            color: #0078d4;
            font-weight: bold;
        }
        
        .internet-required {
            display: inline-block;
            padding: 3px 8px;
            background-color: #e0e0e0;
            border-radius: 3px;
            font-size: 12px;
            margin-left: 10px;
        }
        
        .internet-yes {
            background-color: #ffd7d7;
        }
        
        .internet-no {
            background-color: #d7ffd7;
        }
        
        .data-preservation {
            margin-top: 10px;
            padding: 5px 0;
            border-top: 1px solid #eee;
            font-size: 14px;
        }
        
        .info-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            background-color: #0078d4;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 16px;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .hidden {
            display: none !important;
        }
        
        .command-block {
            background-color: #2d2d2d;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            overflow-x: auto;
        }
        
        .expand-btn {
            background-color: #f0f0f0;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }
        
        footer {
            background-color: #323130;
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-top: 50px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar, .content-area {
                width: 100%;
                margin-right: 0;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Windows 11 Recovery Guide</h1>
        </div>
    </header>
    
    <div class="container">
        <div class="main-content">
            <div class="sidebar">
                <h2>Select Your Scenario</h2>
                <div class="scenario-selector">
                    <button class="scenario-btn active" onclick="showScenario('wont-boot')">System Won't Boot At All</button>
                    <button class="scenario-btn" onclick="showScenario('boots-crashes')">System Boots But Crashes</button>
                    <button class="scenario-btn" onclick="showScenario('blue-screen')">Blue Screen Errors</button>
                    <button class="scenario-btn" onclick="showScenario('hardware')">Hardware Issues Suspected</button>
                    <button class="scenario-btn" onclick="showScenario('new-hardware')">New Hardware/Hard Drive</button>
                    <button class="scenario-btn" onclick="showScenario('enterprise')">Enterprise-Managed Device</button>
                </div>
            </div>
            
            <div class="content-area">
                <!-- System Won't Boot -->
                <div class="scenario-content" id="wont-boot-content">
                    <h2>Recovery Options: System Won't Boot At All</h2>
                    <p>When your Windows 11 system fails to start completely, try these recovery options in the recommended order:</p>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-1">First Option</div>
                        <h3>Startup Repair <span class="internet-required internet-no">No Internet Required</span></h3>
                        <p>Automatically diagnoses and fixes issues that prevent Windows from starting.</p>
                        <ul class="steps-list">
                            <li>Boot to Recovery Environment by forcing shutdown during startup 3 times</li>
                            <li>Select "Troubleshoot" > "Advanced options" > "Startup Repair"</li>
                            <li>Wait for the diagnostic and repair process to complete</li>
                            <li>Restart your computer when prompted</li>
                        </ul>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> This option preserves all user data and applications.
                        </div>
                        <button class="expand-btn" onclick="toggleDetails('startup-repair-details')">Show More Details</button>
                        <div id="startup-repair-details" class="hidden">
                            <p>Startup Repair addresses these common issues:</p>
                            <ul>
                                <li>Missing or corrupted boot configuration data</li>
                                <li>Corrupted system files needed during boot</li>
                                <li>Incompatible drivers preventing boot</li>
                            </ul>
                            <p>If Startup Repair runs multiple times without success, it's an indication that you should try the next recovery option.</p>
                        </div>
                    </div>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-2">Second Option</div>
                        <h3>Command Prompt Recovery <span class="internet-required internet-no">No Internet Required</span></h3>
                        <p>Use command-line tools to manually repair boot issues.</p>
                        <ul class="steps-list">
                            <li>Boot to Recovery Environment</li>
                            <li>Select "Troubleshoot" > "Advanced options" > "Command Prompt"</li>
                            <li>Run boot repair commands (see command list below)</li>
                            <li>Type "exit" and restart your computer</li>
                        </ul>
                        <div class="command-block">
                            bootrec /scanos<br>
                            bootrec /rebuildbcd<br>
                            bootrec /fixmbr<br>
                            bootrec /fixboot<br>
                            bcdboot C:\Windows /s C:
                        </div>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> This option preserves user data but requires technical knowledge.
                        </div>
                    </div>
                </div>
                
                <!-- System Boots But Crashes -->
                <div class="scenario-content hidden" id="boots-crashes-content">
                    <h2>Recovery Options: System Boots But Crashes</h2>
                    <p>When your Windows 11 system starts occasionally but crashes or freezes, try these recovery options:</p>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-1">First Option</div>
                        <h3>Safe Mode <span class="internet-required internet-no">No Internet Required</span></h3>
                        <p>Boot Windows with minimal drivers to identify problematic software.</p>
                        <ul class="steps-list">
                            <li>Press F8 during startup (or from WinRE, select "Troubleshoot" > "Advanced options" > "Startup Settings")</li>
                            <li>Select option 4 or F4 for Safe Mode</li>
                            <li>Once in Safe Mode, uninstall recently added programs or drivers</li>
                            <li>Run System File Checker: Open Command Prompt as admin and type "sfc /scannow"</li>
                        </ul>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> This option preserves all user data and allows troubleshooting.
                        </div>
                    </div>
                </div>
                
                <!-- Blue Screen Errors -->
                <div class="scenario-content hidden" id="blue-screen-content">
                    <h2>Recovery Options: Blue Screen Errors (BSOD)</h2>
                    <p>When your Windows 11 system encounters Blue Screen of Death (BSOD) errors, use these diagnostic and recovery options:</p>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-1">First Option</div>
                        <h3>Safe Mode and Error Analysis <span class="internet-required internet-no">No Internet Required</span></h3>
                        <p>Boot into Safe Mode to analyze the blue screen error code and minidump files.</p>
                        <ul class="steps-list">
                            <li>If system can boot occasionally: Press F8 during startup or hold Shift while clicking Restart</li>
                            <li>If system won't boot: Boot to Recovery Environment > Troubleshoot > Advanced options > Startup Settings > Restart</li>
                            <li>Press 4 or F4 to boot into Safe Mode</li>
                            <li>Once in Safe Mode, note the exact error code from previous blue screen (if visible)</li>
                            <li>Check Event Viewer: Start > type "Event Viewer" > Windows Logs > System > look for Critical errors</li>
                        </ul>
                        <div class="command-block">
                            # View most recent minidump files (from Safe Mode or Command Prompt)
                            dir %SystemRoot%\Minidump\*.dmp /od
                            
                            # Copy minidump files to desktop for analysis
                            mkdir %USERPROFILE%\Desktop\Minidumps
                            copy %SystemRoot%\Minidump\*.dmp %USERPROFILE%\Desktop\Minidumps\
                        </div>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> This diagnostic approach preserves all user data.
                        </div>
                        <button class="expand-btn" onclick="toggleDetails('bsod-codes-details')">Show Common BSOD Codes</button>
                        <div id="bsod-codes-details" class="hidden">
                            <p><strong>Common Blue Screen Error Codes and Causes:</strong></p>
                            <ul>
                                <li><strong>MEMORY_MANAGEMENT (0x0000001A):</strong> Faulty RAM, corrupt system files, incompatible drivers</li>
                                <li><strong>SYSTEM_SERVICE_EXCEPTION (0x0000003B):</strong> Incompatible drivers, system service issues</li>
                                <li><strong>IRQL_NOT_LESS_OR_EQUAL (0x0000000A):</strong> Driver conflicts, hardware issues, RAM problems</li>
                                <li><strong>PAGE_FAULT_IN_NONPAGED_AREA (0x00000050):</strong> RAM issues, corrupt system files, driver conflicts</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-2">Second Option</div>
                        <h3>Driver Rollback or Update <span class="internet-required internet-yes">Internet Recommended</span></h3>
                        <p>Address driver-related blue screens by rolling back or updating problematic drivers.</p>
                        <ul class="steps-list">
                            <li>Boot into Safe Mode as described above</li>
                            <li>Open Device Manager: Right-click Start > Device Manager</li>
                            <li>Expand categories and look for devices with warning icons</li>
                            <li>Right-click problematic device > Properties > Driver tab > Roll Back Driver (if available)</li>
                            <li>If rollback isn't available, update driver from manufacturer's website (not Windows Update)</li>
                        </ul>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> This approach preserves all user data while fixing driver issues.
                        </div>
                    </div>
                </div>
                
                <!-- Hardware Issues -->
                <div class="scenario-content hidden" id="hardware-content">
                    <h2>Recovery Options: Hardware Issues Suspected</h2>
                    <p>When your Windows 11 problems appear to be hardware-related, use these diagnostic and recovery options:</p>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-1">First Option</div>
                        <h3>Windows Memory Diagnostic <span class="internet-required internet-no">No Internet Required</span></h3>
                        <p>Test RAM for errors that may cause system instability.</p>
                        <ul class="steps-list">
                            <li>Boot to Windows Recovery Environment (WinRE)</li>
                            <li>Select "Troubleshoot" > "Advanced options" > "Windows Memory Diagnostic"</li>
                            <li>Choose "Restart now and check for problems"</li>
                            <li>Wait for the memory test to complete (may take 10-30 minutes)</li>
                            <li>System will restart automatically and display results</li>
                        </ul>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> This diagnostic doesn't modify data but requires restart.
                        </div>
                    </div>
                </div>
                
                <!-- New Hardware/Hard Drive -->
                <div class="scenario-content hidden" id="new-hardware-content">
                    <h2>Recovery Options: New Hardware or Hard Drive</h2>
                    <p>When installing Windows 11 on new hardware or after a hard drive failure, use these options:</p>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-1">First Option</div>
                        <h3>USB Installation Media <span class="internet-required internet-yes">Internet Required (for creation)</span></h3>
                        <p>Install Windows 11 using a bootable USB drive.</p>
                        <ul class="steps-list">
                            <li>On another computer, download Media Creation Tool from Microsoft</li>
                            <li>Run the tool and select "Create installation media for another PC"</li>
                            <li>Choose USB flash drive option (8GB+ recommended)</li>
                            <li>Insert the USB drive into the new/repaired computer and boot from it</li>
                            <li>Follow the installation wizard to install Windows 11</li>
                        </ul>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> This is a clean installation on new hardware. No previous data will be preserved.
                        </div>
                    </div>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-2">Second Option</div>
                        <h3>DVD Installation Media <span class="internet-required internet-yes">Internet Required (for creation)</span></h3>
                        <p>Install Windows 11 using an official installation DVD.</p>
                        <ul class="steps-list">
                            <li>On another computer, download Windows 11 ISO from Microsoft</li>
                            <li>Burn ISO to DVD using Windows built-in burning tool or third-party software</li>
                            <li>Insert DVD into the new/repaired computer and boot from it</li>
                            <li>Follow the installation wizard to install Windows 11</li>
                            <li>Activate Windows with your product key or Microsoft account</li>
                        </ul>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> This is a clean installation on new hardware. No previous data will be preserved.
                        </div>
                    </div>
                </div>
                
                <!-- Enterprise-Managed Device -->
                <div class="scenario-content hidden" id="enterprise-content">
                    <h2>Recovery Options: Enterprise-Managed Device</h2>
                    <p>For devices managed by your organization through Microsoft Entra ID, Microsoft Intune, or SCCM, follow these enterprise-specific recovery options:</p>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-1">First Option</div>
                        <h3>Contact IT Support <span class="internet-required internet-no">No Internet Required</span></h3>
                        <p>Your organization's IT department may have specific recovery procedures and tools.</p>
                        <ul class="steps-list">
                            <li>Contact your IT helpdesk through your organization's standard support channels</li>
                            <li>Provide your device information (asset tag, serial number, or hostname)</li>
                            <li>Describe the issue in detail including any error messages</li>
                            <li>Follow their specific instructions for your managed device</li>
                        </ul>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> Your IT department may be able to recover your data remotely.
                        </div>
                    </div>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-2">Second Option</div>
                        <h3>Windows Autopilot Reset <span class="internet-required internet-yes">Internet Required</span></h3>
                        <p>Reset the device while maintaining enrollment in your organization's management system.</p>
                        <ul class="steps-list">
                            <li>If Windows is accessible: Settings > System > Recovery > Reset this PC</li>
                            <li>Choose "Keep my files" or "Remove everything" based on IT policy</li>
                            <li>Select "Cloud download" for the reinstallation source</li>
                            <li>During setup, sign in with your work account when prompted</li>
                            <li>Device will automatically re-enroll and reinstall managed apps</li>
                        </ul>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> Option to keep personal files, but all apps will be reinstalled.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Enterprise-Managed Device -->
                <div class="scenario-content hidden" id="enterprise-content">
                    <h2>Recovery Options: Enterprise-Managed Device</h2>
                    <p>For devices managed by your organization through Microsoft Entra ID, Microsoft Intune, or SCCM, follow these enterprise-specific recovery options:</p>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-1">First Option</div>
                        <h3>Contact IT Support <span class="internet-required internet-no">No Internet Required</span></h3>
                        <p>Your organization's IT department may have specific recovery procedures and tools.</p>
                        <ul class="steps-list">
                            <li>Contact your IT helpdesk through your organization's standard support channels</li>
                            <li>Provide your device information (asset tag, serial number, or hostname)</li>
                            <li>Describe the issue in detail including any error messages</li>
                            <li>Follow their specific instructions for your managed device</li>
                        </ul>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> Your IT department may be able to recover your data remotely.
                        </div>
                    </div>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-2">Second Option</div>
                        <h3>Remote Intune Recovery <span class="internet-required internet-yes">Internet Required</span></h3>
                        <p>Use Microsoft Intune remote management capabilities to recover the device.</p>
                        <ul class="steps-list">
                            <li>IT administrator accesses Microsoft Intune admin center (endpoint.microsoft.com)</li>
                            <li>Locates affected device under Devices > All devices</li>
                            <li>Selects "Remote actions" to perform one of these recovery options:</li>
                            <li>• Fresh Start: Reinstalls Windows while preserving user data</li>
                            <li>• Remote Restart: Forces device to restart</li>
                            <li>• Remote Lock: Secures device if compromised</li>
                            <li>• Sync: Forces device to check in with Intune for policy updates</li>
                        </ul>
                        <div class="command-block">
                            # PowerShell script for IT admins to initiate Fresh Start remotely
                            Connect-MSGraph
                            $deviceId = "DEVICE_ID_HERE"
                            Invoke-DeviceManagementWindowsFreshStart -managedDeviceId $deviceId
                        </div>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> Fresh Start preserves user data but removes OEM apps and non-Store apps.
                        </div>
                        <button class="expand-btn" onclick="toggleDetails('intune-remote-details')">Show More Details</button>
                        <div id="intune-remote-details" class="hidden">
                            <p><strong>Requirements for Remote Intune Recovery:</strong></p>
                            <ul>
                                <li>Device must have previously been enrolled in Intune</li>
                                <li>Internet connectivity (even intermittent) is required</li>
                                <li>IT admins need appropriate RBAC permissions in Intune</li>
                                <li>For BitLocker-enabled devices, recovery keys must be escrowed to Intune</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-2">Third Option</div>
                        <h3>Windows Autopilot Reset <span class="internet-required internet-yes">Internet Required</span></h3>
                        <p>Reset the device while maintaining enrollment in your organization's management system.</p>
                        <ul class="steps-list">
                            <li>If Windows is accessible: Settings > System > Recovery > Reset this PC</li>
                            <li>Choose "Keep my files" or "Remove everything" based on IT policy</li>
                            <li>Select "Cloud download" for the reinstallation source</li>
                            <li>During setup, sign in with your work account when prompted</li>
                            <li>Device will automatically re-enroll and reinstall managed apps</li>
                        </ul>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> Option to keep personal files, but all apps will be reinstalled.
                        </div>
                    </div>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-3">Fourth Option</div>
                        <h3>Provisioning Package Recovery <span class="internet-required internet-no">No Internet Required</span></h3>
                        <p>Use Windows Configuration Designer packages to quickly reconfigure devices without reinstallation.</p>
                        <ul class="steps-list">
                            <li>IT admin creates recovery provisioning package (.ppkg) using Windows Configuration Designer</li>
                            <li>Package is distributed via USB drive to affected device</li>
                            <li>Boot to Windows Recovery Environment (WinRE)</li>
                            <li>Select Troubleshoot > Advanced options > Command Prompt</li>
                            <li>Navigate to the USB drive and run: <code>pkgmgr.exe /auto /add-package /packagepath:path\to\recovery.ppkg</code></li>
                            <li>Restart the device to apply configurations</li>
                        </ul>
                        <div class="command-block">
                            # PowerShell commands to create a recovery provisioning package (for IT admins)
                            Install-Module -Name WindowsAutopilotIntune
                            Import-Module -Name WindowsAutopilotIntune
                            
                            # Export device hash for re-enrollment
                            Get-WindowsAutopilotInfo -OutputFile AutopilotHWID.csv
                            
                            # Create PPKG with Windows Configuration Designer
                            # Then distribute to affected devices
                        </div>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> This preserves user data but reconfigures enterprise settings and enrollment.
                        </div>
                    </div>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-3">Fifth Option</div>
                        <h3>SCCM Task Sequence Recovery <span class="internet-required internet-yes">Internet Required</span></h3>
                        <p>Use Configuration Manager (SCCM) task sequences to restore or rebuild the device.</p>
                        <ul class="steps-list">
                            <li>Boot device to Windows PE environment (F12 during startup or use bootable media)</li>
                            <li>When prompted, select the organization's Task Sequence for OS recovery</li>
                            <li>For in-place recovery: Choose repair/refresh task sequence that preserves user data</li>
                            <li>For full rebuild: Choose full OS deployment task sequence</li>
                            <li>Follow on-screen prompts to complete the deployment</li>
                            <li>Device will automatically rejoin domain and reinstall required applications</li>
                        </ul>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> Data preservation depends on chosen task sequence - refresh preserves data, rebuild erases it.
                        </div>
                        <button class="expand-btn" onclick="toggleDetails('sccm-task-details')">Show More Details</button>
                        <div id="sccm-task-details" class="hidden">
                            <p><strong>SCCM Recovery Task Sequence Types:</strong></p>
                            <ul>
                                <li><strong>In-Place Upgrade:</strong> Reinstalls Windows while preserving apps, settings, and data</li>
                                <li><strong>Refresh:</strong> Reinstalls Windows and apps while preserving user data only</li>
                                <li><strong>Replace:</strong> Full system wipe and reinstall with USMT data restoration</li>
                                <li><strong>Bare-Metal:</strong> Complete rebuild with no data preservation</li>
                            </ul>
                            <p>For devices with User State Migration Tool (USMT) backups, data can be restored even after a full system wipe.</p>
                        </div>
                    </div>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-3">Sixth Option</div>
                        <h3>BitLocker Recovery <span class="internet-required internet-no">No Internet Required</span></h3>
                        <p>Recover access to BitLocker-encrypted drives on enterprise devices.</p>
                        <ul class="steps-list">
                            <li>If prompted for BitLocker recovery key at startup:</li>
                            <li>IT admin retrieves recovery key from one of these sources:</li>
                            <li>• Microsoft Intune admin center: Devices > All devices > Device > Recover BitLocker keys</li>
                            <li>• Microsoft Entra admin center: Devices > All devices > Device > BitLocker keys</li>
                            <li>• Active Directory: Get-ADComputer -Identity "ComputerName" -Properties msFVE-RecoveryPassword</li>
                            <li>• MBAM server (if deployed)</li>
                            <li>Enter the 48-digit recovery key when prompted</li>
                        </ul>
                        <div class="command-block">
                            # PowerShell command for IT admins to retrieve BitLocker recovery keys from AD
                            Get-ADObject -Filter {objectclass -eq 'msFVE-RecoveryInformation'} -SearchBase (Get-ADComputer DEVICENAME).DistinguishedName -Properties 'msFVE-RecoveryPassword'
                            
                            # PowerShell command to retrieve BitLocker recovery keys using Intune Graph API
                            $deviceId = "DEVICE_ID_HERE"
                            Invoke-MSGraphRequest -HttpMethod GET -Url "deviceManagement/managedDevices('$deviceId')/recoveryKeys"
                        </div>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> Properly recovered BitLocker drives preserve all user data.
                        </div>
                    </div>
                    
                    <div class="recovery-option">
                        <div class="priority-badge priority-3">Seventh Option</div>
                        <h3>Cloud Backup Restoration <span class="internet-required internet-yes">Internet Required</span></h3>
                        <p>Restore user data from Microsoft 365 cloud backups after device recovery or replacement.</p>
                        <ul class="steps-list">
                            <li>After OS reinstallation, ensure device is re-enrolled in Intune/joined to Entra ID</li>
                            <li>Sign in with user's Microsoft 365 account</li>
                            <li>OneDrive will automatically start syncing backed-up Desktop, Documents, and Pictures folders</li>
                            <li>For Known Folder Move (KFM) deployments, data restoration is automatic</li>
                            <li>For Exchange data: Setup Outlook and mail will resynchronize</li>
                            <li>For SharePoint data: Reconnect synchronized libraries</li>
                        </ul>
                        <div class="command-block">
                            # PowerShell command to manually force OneDrive Known Folder Move after recovery
                            $registryPath = "HKLM:\SOFTWARE\Policies\Microsoft\OneDrive"
                            if (!(Test-Path $registryPath)) { New-Item -Path $registryPath -Force | Out-Null }
                            Set-ItemProperty -Path $registryPath -Name "KFMSilentOptIn" -Value "YOUR_TENANT_ID_HERE"
                            
                            # Restart OneDrive sync client
                            Get-Process *onedrive* | Stop-Process -Force
                            Start-Process "$env:LOCALAPPDATA\Microsoft\OneDrive\OneDrive.exe"
                        </div>
                        <div class="data-preservation">
                            <span class="info-icon">i</span> Restores cloud-backed up data only; local-only data cannot be recovered.
                        </div>
                    </div>
                </div>
    
    <footer>
        <div class="container">
            <p>© 2025 Windows 11 Recovery Guide | Created for IT Professionals</p>
        </div>
    </footer>
    
    <script>
        // Simple function to show scenarios
        function showScenario(scenarioId) {
            // Hide all scenario contents
            const allContents = document.querySelectorAll('.scenario-content');
            allContents.forEach(content => {
                content.classList.add('hidden');
            });
            
            // Show selected scenario
            const selectedContent = document.getElementById(scenarioId + '-content');
            if (selectedContent) {
                selectedContent.classList.remove('hidden');
            }
            
            // Update button active state
            const allButtons = document.querySelectorAll('.scenario-btn');
            allButtons.forEach(button => {
                button.classList.remove('active');
            });
            
            // Find the clicked button by the scenario it shows
            const clickedButton = document.querySelector(`.scenario-btn[onclick*="${scenarioId}"]`);
            if (clickedButton) {
                clickedButton.classList.add('active');
            }
        }
        
        // Toggle details sections
        function toggleDetails(detailsId) {
            const detailsElement = document.getElementById(detailsId);
            const button = event.target;
            
            if (detailsElement.classList.contains('hidden')) {
                detailsElement.classList.remove('hidden');
                button.textContent = 'Show Less';
            } else {
                detailsElement.classList.add('hidden');
                button.textContent = 'Show More Details';
            }
        }
        
        // Make sure we start with only first scenario visible
        document.addEventListener('DOMContentLoaded', function() {
            showScenario('wont-boot');
        });
    </script>
</body>
</html>
